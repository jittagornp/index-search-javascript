<html>
    <head>
        <style>
            .highlighter{
                color : red;
            }

            .level-0 > a{
                font-weight: bold; 
            }
        </style>
    </head>
    <body>
        <script src="jquery.js"></script>
        <script src="repository.js"></script>
        <script src="additionalDictionaries.js"></script>
        <script src="indexsearch.js"></script>
        <script>
            (function($, node) {
                $(function() {
                    //==========================================================
                    var indexSearch__ = new IndexSearch(node, {
                        maximumIndexKeySize: 5,
                        indexOnFields: ['name'],
                        additionalDictionaries: additionalDictionaries
                    });
                    //==========================================================
                    
                    var $inputSearch = $('#inputSearch');
                    var $resultSearch = $('#resultSearch');

                    showResult(node);
                    $inputSearch.keyup(function() {
                        var keyword = $inputSearch.val();
                        var result = indexSearch__.search(keyword);
                        console.log(indexSearch__.getKeyword() + ' : total => ' + result.getTotalHighlight());
                        showResult(result.getContent());
                    });

                    function showResult(result) {
                        var ul = $('<ul>');
                        $resultSearch.html(ul);
                        walkRepositoryShowResult(result, ul);
                    }

                    function walkRepositoryShowResult(node, parentDOM) {
                        var nodes = node.nodes;
                        if (!nodes || nodes.length === 0) {
                            return;
                        }

                        for (var index in nodes) {
                            var nd = nodes[index];
                            var link = $('<a>').attr('href', nd.link).html(nd.nameHighlight || nd.name);
                            var childDOM = $('<ol>');
                            var li = $('<li>').attr('class', nd.level).append(link).append(childDOM);
                            parentDOM.append(li);

                            walkRepositoryShowResult(nd, childDOM);
                        }
                    }
                });
            })(jQuery, node);
        </script>

        <input id="inputSearch"/>
        <div id="resultSearch"></div>
    </body>
</html>